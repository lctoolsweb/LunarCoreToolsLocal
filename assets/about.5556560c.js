var c=(e,s,d)=>new Promise((a,r)=>{var t=i=>{try{l(d.next(i))}catch(u){r(u)}},o=i=>{try{l(d.throw(i))}catch(u){r(u)}},l=i=>i.done?a(i.value):Promise.resolve(i.value).then(t,o);l((d=d.apply(e,s)).next())});import{b as _,e as h,g as n,aa as m,ab as p}from"./index.26eef5ff.js";import{_ as v}from"./_plugin-vue_export-helper.cdc0426e.js";const f={data(){return{serverAddress:"",uid:""}},methods:{testConnection(){return c(this,null,function*(){try{const e=yield this.sendRequest("ping",{},this.serverAddress);if(console.log(e),e.retcode===200)alert("\u670D\u52A1\u5668\u8FDE\u63A5\u6210\u529F"),this.serverAddress=e.data.serverAddress;else throw new Error("\u670D\u52A1\u5668\u8FDE\u63A5\u5931\u8D25")}catch(e){console.error(e)}})},sendVerificationCode(){return c(this,null,function*(){try{const e=parseInt(this.uid,10);if(isNaN(e))throw new Error("UID\u5FC5\u987B\u662F\u4E00\u4E2A\u6574\u6570");const s=yield this.sendRequest("sendCode",{uid:e},this.serverAddress,"no-cors");if(console.log(s),s.retcode===200)alert("\u9A8C\u8BC1\u7801\u53D1\u9001\u6210\u529F");else throw new Error("\u9A8C\u8BC1\u7801\u53D1\u9001\u5931\u8D25: "+s.message)}catch(e){console.error(e)}})},sendRequest(e,s,d,a="cors"){return c(this,null,function*(){const r=`http://${d}/opencommand/api`;try{const t=yield fetch(r,{method:"POST",mode:a,headers:{"Content-Type":"application/json"},body:JSON.stringify({action:e,data:s})});if(t.ok)return{retcode:200,message:"Success"};throw new Error(`Failed to send ${e} request. Status: ${t.status}`)}catch(t){throw new Error(`Failed to send ${e} request: ${t.message}`)}})}}},w={id:"app"},y={class:"commuse"},C={class:"commuse-item"},g=n("div",null,"\u670D\u52A1\u5668\u5730\u5740\uFF1A",-1),b={class:"commuse-item"},A=n("div",null,"UID\uFF1A",-1);function E(e,s,d,a,r,t){return _(),h("div",w,[n("div",y,[n("div",C,[g,m(n("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>r.serverAddress=o)},null,512),[[p,r.serverAddress]]),n("button",{onClick:s[1]||(s[1]=(...o)=>t.testConnection&&t.testConnection(...o))},"\u786E\u5B9A")]),n("div",b,[A,m(n("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>r.uid=o)},null,512),[[p,r.uid]]),n("button",{onClick:s[3]||(s[3]=(...o)=>t.sendVerificationCode&&t.sendVerificationCode(...o))},"\u53D1\u9001\u9A8C\u8BC1\u7801")])])])}const x=v(f,[["render",E]]);export{x as default};
