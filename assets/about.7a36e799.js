var c=(e,s,n)=>new Promise((a,r)=>{var t=d=>{try{l(n.next(d))}catch(u){r(u)}},o=d=>{try{l(n.throw(d))}catch(u){r(u)}},l=d=>d.done?a(d.value):Promise.resolve(d.value).then(t,o);l((n=n.apply(e,s)).next())});import{b as p,e as h,f as i,ab as f,ac as m}from"./index.21cc1993.js";import{_ as w}from"./_plugin-vue_export-helper.cdc0426e.js";const _={data(){return{serverAddress:"",uid:""}},methods:{testConnection(){return c(this,null,function*(){try{const e=yield this.sendRequest("ping",{},this.serverAddress);if(console.log(e),e.retcode===200)alert("\u670D\u52A1\u5668\u8FDE\u63A5\u6210\u529F"),this.serverAddress=e.data.serverAddress;else throw new Error("\u670D\u52A1\u5668\u8FDE\u63A5\u5931\u8D25")}catch(e){console.error(e)}})},sendVerificationCode(){return c(this,null,function*(){try{const e=parseInt(this.uid,10);if(isNaN(e))throw new Error("UID\u5FC5\u987B\u662F\u4E00\u4E2A\u6574\u6570");const s=yield this.sendRequest("sendCode",{uid:e},this.serverAddress,"no-cors");if(console.log(s),s.retcode===200)alert("\u9A8C\u8BC1\u7801\u53D1\u9001\u6210\u529F");else throw new Error("\u9A8C\u8BC1\u7801\u53D1\u9001\u5931\u8D25: "+s.message)}catch(e){console.error(e)}})},sendRequest(e,s,n,a="cors"){return c(this,null,function*(){const r=`http://${n}/opencommand/api`;try{const t=yield fetch(r,{method:"POST",mode:a,headers:{"Content-Type":"application/json"},body:JSON.stringify({action:e,data:s})});if(t.ok)return{retcode:200,message:"Success"};throw new Error(`Failed to send ${e} request. Status: ${t.status}`)}catch(t){throw new Error(`Failed to send ${e} request: ${t.message}`)}})},sendNotification(){"Notification"in window?Notification.permission==="granted"?this.showNotification():Notification.permission!=="denied"&&Notification.requestPermission().then(e=>{e==="granted"&&this.showNotification()}):alert("\u8BE5\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u7CFB\u7EDF\u901A\u77E5\u529F\u80FD\uFF01")},showNotification(){new Notification("\u6D4B\u8BD5\u901A\u77E5",{body:"\u8FD9\u662F\u4E00\u6761\u6D4B\u8BD5\u901A\u77E5"})}}},v={id:"app"},N={class:"commuse"},y={class:"commuse-item"},C=i("div",null,"\u670D\u52A1\u5668\u5730\u5740\uFF1A",-1),g={class:"commuse-item"},b=i("div",null,"UID\uFF1A",-1);function A(e,s,n,a,r,t){return p(),h("div",v,[i("div",N,[i("div",y,[C,f(i("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>r.serverAddress=o)},null,512),[[m,r.serverAddress]]),i("button",{onClick:s[1]||(s[1]=(...o)=>t.testConnection&&t.testConnection(...o))},"\u786E\u5B9A")]),i("div",g,[b,f(i("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>r.uid=o)},null,512),[[m,r.uid]]),i("button",{onClick:s[3]||(s[3]=(...o)=>t.sendVerificationCode&&t.sendVerificationCode(...o))},"\u53D1\u9001\u9A8C\u8BC1\u7801")])]),i("button",{onClick:s[4]||(s[4]=(...o)=>t.sendNotification&&t.sendNotification(...o))},"\u6D4B\u8BD5\u901A\u77E5")])}const V=w(_,[["render",A]]);export{V as default};
